# Routing(라우팅)

### 1. 페이지 url 경로
- pages 폴더에 js파일 생성하기만 하면 파일의 경로가 url 경로가 된다. `파일명`대로 url.
- 중간에 폴더를 만들면 폴더까지 url 경로가 된다.
```javascript
// pages 폴더 -> posts폴더 -> first-post.js =>  http://localhost:3000/posts/first-post

export default function FirstPost(){ 
// "export default"는 중요, 컴포넌트 명은 중요하지x, 파일명대로 url
  return <h1>First Post</h1>
}
```
- index.js 페이지는 홈 페이지 - localhost:3000/ (o), localhost:3000/index (x)
- 예시   
 `pages/index.js → /`   
 `pages/blog/index.js → /blog`
- useState 이런 거 쓰고 싶을 때는 import react 해야하지만 안 쓰면 import react 안해도 됨!

### 2. Link 컴포넌트(페이지 간 연결)
#### 2-1. Link 컴포넌트 사용 이유
- a 태그를 쓰면 페이지 이동할 때마다 전체 어플리케이션 새로고침 처리 된다(느려짐)
#### 2-2. Link 컴포넌트 안에 a 태그 쓰는 이유
- Link 컴포넌트 속성으로는 href만 넣을 수 있다, style 같은 것을 위해 a 태그 넣어준다!
```javascript
import Link from 'next/link

<h1 className="title">
  Read{' '}    // {' '} 여러 줄에 걸쳐 텍스트를 나누는 데 사용되는 빈 공간을 추가합니다.
  <Link href="/posts/first-post">
    <a>this page!</a>
  </Link>
</h1>
```
### 3. useRouter
```javascript
import {useRouter} from 'next/router'

export default function ReadMore(){
  const router = useRouter()
  console.log(router); // { asPath: "/", back: f(), ... pathname: "/"} 이런 기타등등 router 객체 나옴, router.pathname이 현재 주소인 "/"를 가리킴
  return (
    <button onClick={() => router.push('/about')}>
      Click here to read more
    </button>
  )
}
```
### 4. Dynamic Routes
```javascript
// pages/post/[pid].js
import {useRouter} from 'next/router'

const Post = () => {
  const router = useRouter()
  const {pid} = router.query
  
  return <p>Post: {pid}</p>
}
export default Post
```
- Catch all routes
```javascript
// pages/post/[...slug].js
{"slug": ["a"]} → /post/a
{"slug": ["a", "b"]} → /post/a/b 
```
- Optional catch all routes
```javascript
{ } → /post (empty object) // 위의 Catch all routes와 가장 큰 차이점
{ "slug": ["a"] } → /post/a
{ "slug": ["a", "b"] } → /post/a/b 
```

#### 4-1. Dynamic Routes 예시, 만약에 /movies, /movies/all 이런 url 만들고 싶다면?
- pages 폴더 안에 movies 폴더를 만들고, index.js, all.js 파일 만든다 -> 사실 이렇게 안해도 되긴함!
- 밑의 그림처럼 [변수명].js 이렇게 만들어준다!(여기 변수명은 router의 query property가 된다!)
- => 이게 바로 Dynamic URL   
![image](https://user-images.githubusercontent.com/61729276/151123171-e72ff8f1-7bbd-4428-9f2d-bb973199a04b.png)
```javascript
// pages/index.js
import {useRouter} from 'next/router'

export default function Home({result}){
  const router = useRouter(); // useRouter를 이용해서 router를 만들고
  const onClick = (id) =>{
    router.push(`/movies/${id}`)
  }
...
        {results?.map((movie) => (
            <div onClick={()=>onClick(movie.id) className='movie' key={movie.id}> // 클릭 시 이동!
                <img
                  src={`https://image.tmdb.org/t/p/w500${movie.poster_path}`}
                />
                <Link href={`/movies/${movie.id}`} key={movie.id}> // 클릭 시 이동!
                  <a>
                    <h4>{movie.original_title}</h4>
                  </a>
                </Link>
              </div>
        ))}
```

#### 4-2. URL에서 URL로 state 전달! + url mask(as)
- user가 들어가서 클릭했을 때 유효!, 시크릿모드에서는 x
```javascript
// pages/[index].js
    const onClick = (id, title) => {
    router.push({
      pathname: `/movies/${id}`,
      query: {
        title,
      }
    },
    `/movies/${id}`)
  }
  ...
  // <Link></Link> 도 가능
  <Link href={{
  pathname: `/movies/${movie.id}`,
  query: {title: movie.original_title,},
  }}
  as={`/movies/${movie.id}`}>
```
```javascript
//pages/[id].js
import { useRouter } from "next/router";

export default function Detail(){
    const router = useRouter();
    console.log(router);
    return <h4>{router.query.title || "Loading..."}</h4>;
    // 시크릿모드로 들어가면 Loading...으로 뜬다.(user가 들어가서 클릭했을 때만 유효하게 뜬다!)
}
```
